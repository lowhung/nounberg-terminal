<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nounberg Terminal API Documentation</title>
  <style>
    :root {
      --primary-color: #3b82f6;
      --secondary-color: #1e40af;
      --text-color: #333;
      --code-bg: #f1f5f9;
      --border-color: #e5e7eb;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: var(--text-color);
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.5rem;
    }
    
    h2 {
      font-size: 1.8rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: var(--secondary-color);
    }
    
    h3 {
      font-size: 1.3rem;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }
    
    p {
      margin-bottom: 1rem;
    }
    
    ul, ol {
      margin-bottom: 1rem;
      padding-left: 1.5rem;
    }
    
    li {
      margin-bottom: 0.5rem;
    }
    
    code {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      padding: 0.2rem 0.4rem;
      background-color: var(--code-bg);
      border-radius: 3px;
      font-size: 0.9rem;
    }
    
    pre {
      background-color: var(--code-bg);
      padding: 1rem;
      border-radius: 5px;
      overflow-x: auto;
      margin-bottom: 1rem;
    }
    
    pre code {
      padding: 0;
      background-color: transparent;
    }
    
    .endpoint {
      margin-bottom: 2rem;
      padding: 1rem;
      border: 1px solid var(--border-color);
      border-radius: 5px;
    }
    
    .method {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 3px;
      color: white;
      margin-right: 0.5rem;
      font-weight: bold;
    }
    
    .get {
      background-color: #22c55e;
    }
    
    .post {
      background-color: #f59e0b;
    }
    
    .ws {
      background-color: #a855f7;
    }
    
    .parameters {
      margin-top: 1rem;
    }
    
    .parameter {
      margin-bottom: 0.5rem;
      padding-left: 1rem;
      border-left: 3px solid var(--border-color);
    }
    
    .parameter-name {
      font-weight: bold;
    }
    
    .parameter-type {
      font-style: italic;
      color: #666;
    }
    
    .response {
      margin-top: 1rem;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }
    
    th, td {
      padding: 0.5rem;
      text-align: left;
      border: 1px solid var(--border-color);
    }
    
    th {
      background-color: #f8fafc;
    }
    
    .example-title {
      margin-top: 1rem;
      font-weight: bold;
    }
    
    .header-anchor {
      margin-left: 0.5rem;
      font-size: 1rem;
      text-decoration: none;
      opacity: 0.5;
    }
    
    .header-anchor:hover {
      opacity: 1;
    }

    /* Dark mode */
    @media (prefers-color-scheme: dark) {
      :root {
        --primary-color: #3b82f6;
        --secondary-color: #60a5fa;
        --text-color: #e5e7eb;
        --code-bg: #1e293b;
        --border-color: #374151;
      }
      
      body {
        background-color: #0f172a;
      }
      
      th {
        background-color: #1e293b;
      }
    }
  </style>
</head>
<body>
  <h1>Nounberg Terminal API Documentation</h1>
  <p>
    This documentation describes how to use the Nounberg Terminal API to access Nouns DAO auction events.
    The API provides both REST endpoints and WebSocket connections for real-time updates.
  </p>

  <h2 id="rest-api">REST API <a href="#rest-api" class="header-anchor">#</a></h2>
  
  <div class="endpoint">
    <h3>
      <span class="method get">GET</span> /api/events
    </h3>
    <p>Retrieves auction events with pagination.</p>
    
    <div class="parameters">
      <h4>Query Parameters:</h4>
      <div class="parameter">
        <div class="parameter-name">limit</div>
        <div class="parameter-type">number (optional, default: 10)</div>
        <p>Maximum number of events to return.</p>
      </div>
      
      <div class="parameter">
        <div class="parameter-name">cursor</div>
        <div class="parameter-type">string (optional)</div>
        <p>Pagination cursor for fetching the next page of results.</p>
      </div>

      <div class="parameter">
        <div class="parameter-name">type</div>
        <div class="parameter-type">string (optional)</div>
        <p>Filter events by type: "AuctionCreated", "AuctionBid", or "AuctionSettled".</p>
      </div>

      <div class="parameter">
        <div class="parameter-name">nounId</div>
        <div class="parameter-type">number (optional)</div>
        <p>Filter events by Noun ID.</p>
      </div>
    </div>

    <div class="response">
      <h4>Response Format:</h4>
      <pre><code>{
  "items": [
    {
      "id": "string",
      "blockNumber": "number",
      "blockHash": "string",
      "transactionHash": "string",
      "type": "string",
      "nounId": "number",
      "value": "string", // ETH amount
      "valueUsd": "string", // USD equivalent
      "bidder": "string", // Ethereum address
      "bidderEns": "string", // ENS name if available
      "winner": "string", // Ethereum address
      "winnerEns": "string", // ENS name if available
      "thumbnailUrl": "string",
      "headline": "string",
      "createdAt": "number" // Unix timestamp
    },
    // ...more events
  ],
  "nextCursor": "string" // Cursor for the next page, null if no more results
}</code></pre>
    </div>

    <div class="example-title">Example Request:</div>
    <pre><code>GET /api/events?limit=5&type=AuctionSettled</code></pre>
  </div>

  <div class="endpoint">
    <h3>
      <span class="method get">GET</span> /api/events/:id
    </h3>
    <p>Retrieves a specific auction event by ID.</p>

    <div class="parameters">
      <h4>Path Parameters:</h4>
      <div class="parameter">
        <div class="parameter-name">id</div>
        <div class="parameter-type">string (required)</div>
        <p>The unique ID of the event to retrieve.</p>
      </div>
    </div>

    <div class="response">
      <h4>Response Format:</h4>
      <pre><code>{
  "id": "string",
  "blockNumber": "number",
  "blockHash": "string",
  "transactionHash": "string",
  "type": "string",
  "nounId": "number",
  "value": "string", // ETH amount
  "valueUsd": "string", // USD equivalent
  "bidder": "string", // Ethereum address
  "bidderEns": "string", // ENS name if available
  "winner": "string", // Ethereum address
  "winnerEns": "string", // ENS name if available
  "thumbnailUrl": "string",
  "headline": "string",
  "createdAt": "number" // Unix timestamp
}</code></pre>
    </div>
    
    <div class="example-title">Example Request:</div>
    <pre><code>GET /api/events/abc123def456</code></pre>
  </div>

  <div class="endpoint">
    <h3>
      <span class="method get">GET</span> /api/health
    </h3>
    <p>API health check endpoint.</p>

    <div class="response">
      <h4>Response Format:</h4>
      <pre><code>{
  "status": "ok",
  "version": "1.0.0",
  "uptime": 12345 // seconds
}</code></pre>
    </div>
  </div>

  <h2 id="websocket-api">WebSocket API <a href="#websocket-api" class="header-anchor">#</a></h2>

  <div class="endpoint">
    <h3>
      <span class="method ws">WS</span> /ws
    </h3>
    <p>Real-time auction events via WebSocket connection.</p>

    <h4>Connection:</h4>
    <p>Connect to the WebSocket endpoint using standard WebSocket protocols:</p>
    <pre><code>const socket = new WebSocket('ws://your-api-domain.com/ws');</code></pre>

    <h4>Subscribing to Events:</h4>
    <p>After connection, send a subscription message:</p>
    <pre><code>socket.send(JSON.stringify({ type: 'subscribe' }));</code></pre>

    <h4>Message Types:</h4>
    <table>
      <thead>
        <tr>
          <th>Message Type</th>
          <th>Direction</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>welcome</code></td>
          <td>Server → Client</td>
          <td>Sent upon successful connection</td>
        </tr>
        <tr>
          <td><code>subscribe</code></td>
          <td>Client → Server</td>
          <td>Request to subscribe to event updates</td>
        </tr>
        <tr>
          <td><code>subscribed</code></td>
          <td>Server → Client</td>
          <td>Confirmation of successful subscription</td>
        </tr>
        <tr>
          <td><code>event</code></td>
          <td>Server → Client</td>
          <td>Auction event data</td>
        </tr>
        <tr>
          <td><code>ping</code></td>
          <td>Server → Client</td>
          <td>Heartbeat to keep connection alive</td>
        </tr>
        <tr>
          <td><code>pong</code></td>
          <td>Client → Server</td>
          <td>Response to ping</td>
        </tr>
      </tbody>
    </table>

    <h4>Example Event Message:</h4>
    <pre><code>{
  "type": "event",
  "data": {
    "id": "string",
    "blockNumber": "number",
    "blockHash": "string",
    "transactionHash": "string",
    "type": "string",
    "nounId": "number",
    "value": "string",
    "valueUsd": "string",
    "bidder": "string",
    "bidderEns": "string",
    "winner": "string",
    "winnerEns": "string",
    "thumbnailUrl": "string",
    "headline": "string",
    "createdAt": "number"
  }
}</code></pre>

    <h4>WebSocket Event Handling Example:</h4>
    <pre><code>const socket = new WebSocket('ws://your-api-domain.com/ws');

socket.onopen = () => {
  console.log('Connected to WebSocket');
  socket.send(JSON.stringify({ type: 'subscribe' }));
};

socket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  
  if (data.type === 'welcome') {
    console.log('Connected to server:', data.message);
  } else if (data.type === 'subscribed') {
    console.log('Successfully subscribed to events');
  } else if (data.type === 'event' && data.data) {
    console.log('Received auction event:', data.data);
    // Handle the new event data
  } else if (data.type === 'ping') {
    socket.send(JSON.stringify({ type: 'pong' }));
  }
};

socket.onclose = (event) => {
  console.log(`WebSocket disconnected with code ${event.code}`);
};

socket.onerror = (error) => {
  console.error('WebSocket error:', error);
};</code></pre>
  </div>

  <h2 id="rate-limits">Rate Limits <a href="#rate-limits" class="header-anchor">#</a></h2>
  <p>
    The API has the following rate limits:
  </p>
  <ul>
    <li>REST API: 100 requests per minute per IP address.</li>
    <li>WebSocket: 5 connections per IP address.</li>
  </ul>
  <p>
    Exceeding these limits may result in HTTP 429 responses or connection drops.
  </p>

  <h2 id="errors">Error Handling <a href="#errors" class="header-anchor">#</a></h2>
  <p>
    The API uses standard HTTP status codes to indicate the success or failure of requests:
  </p>
  <table>
    <thead>
      <tr>
        <th>Status Code</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>200</td>
        <td>Success</td>
      </tr>
      <tr>
        <td>400</td>
        <td>Bad Request - The request was invalid or cannot be served</td>
      </tr>
      <tr>
        <td>401</td>
        <td>Unauthorized - Authentication is required</td>
      </tr>
      <tr>
        <td>403</td>
        <td>Forbidden - The server understood but refuses to authorize</td>
      </tr>
      <tr>
        <td>404</td>
        <td>Not Found - The requested resource could not be found</td>
      </tr>
      <tr>
        <td>429</td>
        <td>Too Many Requests - Rate limit exceeded</td>
      </tr>
      <tr>
        <td>500</td>
        <td>Internal Server Error - An error occurred on the server</td>
      </tr>
    </tbody>
  </table>

  <p>
    Error responses will have the following format:
  </p>
  <pre><code>{
  "error": {
    "code": "string",
    "message": "string"
  }
}</code></pre>

  <footer style="margin-top: 3rem; padding-top: 1rem; border-top: 1px solid var(--border-color); text-align: center; font-size: 0.9rem; color: #666;">
    <p>Nounberg Terminal API Documentation © 2025</p>
  </footer>
</body>
</html>
